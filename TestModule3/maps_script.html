<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<head>
    <style>
        #map {
            height: 100%;
            width: 100%;
        }
    </style>
    <title>Maps</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link rel="stylesheet" href="bootstrap.min.css" />
    <link src="map.css" rel='stylesheet' type='text/css'/>
    <script src="../Graph/js/jquery-3.3.1.min.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
    <script src="bootstrap.min.js"></script>
</head>

<body>
    <div id="map"></div>
    <!-- Hide controls until they are moved into the map. -->
    <div style="display: none">
      <div class="controls zoom-control">
        <button class="zoom-control-in" title="Zoom In">+</button>
        <button class="zoom-control-out" title="Zoom Out">âˆ’</button>
      </div>
      <div class="controls maptype-control maptype-control-is-map">
        <button class="maptype-control-map" title="Show road map">Map</button>
        <button
          class="maptype-control-satellite"
          title="Show satellite imagery"
        >
          Satellite
        </button>
      </div>
      <div class="controls fullscreen-control">
        <button title="Toggle Fullscreen">
          <div
            class="fullscreen-control-icon fullscreen-control-top-left"
          ></div>
          <div
            class="fullscreen-control-icon fullscreen-control-top-right"
          ></div>
          <div
            class="fullscreen-control-icon fullscreen-control-bottom-left"
          ></div>
          <div
            class="fullscreen-control-icon fullscreen-control-bottom-right"
          ></div>
        </button>
      </div>
    </div>
    <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBIwzALxUPNbatRBj3Xi1Uhp0fFzwWNBkE&libraries=drawing&callback=initMap">
    </script>
    <script>
        var here = {
            lat: 10.760928821426653,
            lng: 106.68241515925986,
        };
        let map;

        function initMap() {
            map = new google.maps.Map(document.querySelector("#map"), {
                center: here,
                zoom: 17,
                disableDefaultUI: true,
            });
            initZoomControl(map);
            initMapTypeControl(map);
            initFullscreenControl(map);

            //marker.addListener("click", toggleBounce);
            const locationButton = document.createElement("button");
            locationButton.textContent = "Pan to Current Location";
            locationButton.classList.add("custom-map-control-button");
            map.controls[google.maps.ControlPosition.TOP_CENTER].push(locationButton);
            locationButton.addEventListener("click", () => {
                // Try HTML5 geolocation.
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(
                        (position) => {
                            var pos = {
                                lat: position.coords.latitude,
                                lng: position.coords.longitude,
                            };
                            map.setCenter(pos);
                            marker = new google.maps.Marker({
                                map,
                                draggable: true,
                                animation: google.maps.Animation.DROP,
                                position: pos,
                            });
                        },
                        () => {
                            handleLocationError(true, infoWindow, map.getCenter());
                        }
                    );
                } else {
                    // Browser doesn't support Geolocation
                    handleLocationError(false, infoWindow, map.getCenter());
                }
            });


            // let infoWindow = new google.maps.InfoWindow({
            //     content: "Click the map to get Lat/Lng!",
            //     position: here,
            // });
            // infoWindow.open(map);
            map.addListener("click", (e) => {
                //infoWindow.close();
                placeMarkerAndPanTo(e.latLng, map);
                // infoWindow = new google.maps.InfoWindow({
                //     position: e.latLng,
                // });
                // infoWindow.setContent(
                //     JSON.stringify(e.latLng.toJSON(), null, 2)
                // );
                // infoWindow.open(map);
            });
        }


        function toggleBounce() {
            if (marker.getAnimation() !== null) {
                marker.setAnimation(null);
            } else {
                marker.setAnimation(google.maps.Animation.BOUNCE);
            }
        }

        function handleLocationError(browserHasGeolocation, infoWindow, pos) {
            infoWindow.setPosition(pos);
            infoWindow.setContent(
                browserHasGeolocation ?
                "Error: The Geolocation service failed." :
                "Error: Your browser doesn't support geolocation."
            );
            infoWindow.open(map);
        }

        function deleteMarkers() {
            clearMarkers();
            markers = [];
        }

        function placeMarkerAndPanTo(latLng, map) {
            new google.maps.Marker({
                position: latLng,
                map: map,
            });
        }

        function initZoomControl(map) {
            document.querySelector(".zoom-control-in").onclick = function () {
                map.setZoom(map.getZoom() + 1);
            };

            document.querySelector(".zoom-control-out").onclick = function () {
                map.setZoom(map.getZoom() - 1);
            };
            map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(
                document.querySelector(".zoom-control")
            );
        }

        function initMapTypeControl(map) {
            const mapTypeControlDiv = document.querySelector(".maptype-control");

            document.querySelector(".maptype-control-map").onclick = function () {
                mapTypeControlDiv.classList.add("maptype-control-is-map");
                mapTypeControlDiv.classList.remove("maptype-control-is-satellite");
                map.setMapTypeId("roadmap");
            };

            document.querySelector(".maptype-control-satellite").onclick = function () {
                mapTypeControlDiv.classList.remove("maptype-control-is-map");
                mapTypeControlDiv.classList.add("maptype-control-is-satellite");
                map.setMapTypeId("hybrid");
            };
            map.controls[google.maps.ControlPosition.LEFT_TOP].push(mapTypeControlDiv);
        }

        function initFullscreenControl(map) {
            const elementToSendFullscreen = map.getDiv().firstChild;
            const fullscreenControl = document.querySelector(".fullscreen-control");
            map.controls[google.maps.ControlPosition.RIGHT_TOP].push(fullscreenControl);

            fullscreenControl.onclick = function () {
                if (isFullscreen(elementToSendFullscreen)) {
                    exitFullscreen();
                } else {
                    requestFullscreen(elementToSendFullscreen);
                }
            };

            document.onwebkitfullscreenchange = document.onmsfullscreenchange = document.onmozfullscreenchange =
                document.onfullscreenchange = function () {
                    if (isFullscreen(elementToSendFullscreen)) {
                        fullscreenControl.classList.add("is-fullscreen");
                    } else {
                        fullscreenControl.classList.remove("is-fullscreen");
                    }
                };
        }

        function isFullscreen(element) {
            return (
                (document.fullscreenElement ||
                    document.webkitFullscreenElement ||
                    document.mozFullScreenElement ||
                    document.msFullscreenElement) == element
            );
        }

        function requestFullscreen(element) {
            if (element.requestFullscreen) {
                element.requestFullscreen();
            } else if (element.webkitRequestFullScreen) {
                element.webkitRequestFullScreen();
            } else if (element.mozRequestFullScreen) {
                element.mozRequestFullScreen();
            } else if (element.msRequestFullScreen) {
                element.msRequestFullScreen();
            }
        }

        function exitFullscreen() {
            if (document.exitFullscreen) {
                document.exitFullscreen();
            } else if (document.webkitExitFullscreen) {
                document.webkitExitFullscreen();
            } else if (document.mozCancelFullScreen) {
                document.mozCancelFullScreen();
            } else if (document.msExitFullscreen) {
                document.msExitFullscreen();
            }
        }
    </script>
</body>

</html>